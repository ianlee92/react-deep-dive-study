### 📅 2024년 3월 20일

# 📚 3장 리액트 훅 깊게 살펴보기

- 렌더링은 어떻게 일어날까?
  - return문을 실행한 다음, 이 실행 결과를 이전의 리액트 트리와 비교해 리렌더링이 필요한 부분만 업데이트한다.

### useState

클로저를 사용함으로써 외부에 해당 값을 노출시키지 않고 오직 리액트에서만 쓸 수 있었고, 함수형 컴포넌트가 매번 실행되더라도 useState에서 이전의 값을 정확하게 꺼내 쑬 수 있게 되었다.

#### 게으른 초기화

게으른 초기화는 useState의 초기값을 할당할 때 값을 반환하는 함수를 정의하는 방법이다.

useState의 초기값으로 사용된 함수는 최초 렌더링시에만 호출되고 이후의 리렌더링 시점에서는 무시된다. 따라서 자바스크립트에 많은 비용을 요구하는 작업이 들어가 있는 경우에 사용하는 것이 좋다.

```jsx
const [count, setCount] = useState(() =>
  Number.parseInt(window.localStorage.getItem(cacheKey))
);
```

ex) localStorage나 SessionStorage에 접근, map, filter, find와 같은 배열에 대한 접근, 또는 초기값 계산을 위해 함수 효출이 필요한 경우 등

### useEffect

- 애플리케이션 내 컴포넌트의 여러 값들을 활용해 동기적으로 부수효과를 만드는 메커니즘.
- state와 props의 변화 속에서 일어나는 렌더링 과정에서 실행되는 부수효과 함수.
- 어떤 상태값과 함께 실행되는가?

- 클린업 함수가 실행되는 타이밍

  - useEffect의 콜백이 실행될 때 이전의 클린업 함수가 존재한다면 그 클린업 함수를 실행한 뒤에 콜백을 실행한다.
  - 이때 실행되는 클린업 함수는 **이전 렌더링 시의 state와 함께 실행**된다.
  - 언마운트와는 조금 다름. 언마운트는 특정 컴포넌트가 DOM에서 사라지는 시점을 의미.

- 의존성 배열
  - 빈 배열: 최초 렌더링 직후에 실행된 이후 실행되지 않음.
  - 아무 값도x: 렝더링이 발생할 때마다 실행.
  - Object.is를 기반으로 하는 얕은 비교를 수행한다.

부수효과가 뭐지? 함수형 컴포넌트에서 외부 값을 변화시키는 행위, 데이터 페칭

- hook이 실행 순서를 보장받을 수 있는 최상단에 선언되어있어야 하는 이유
  - 리액트 훅은 파이버 객체의 링크드 리스트의 호출 순서 따라 저장되고, 이 고정된 순서를 기준으로 이전 값과의 비교 및 실행이 가능하다.

# 📚 5장 리액트와 상태 관리 라이브러리
